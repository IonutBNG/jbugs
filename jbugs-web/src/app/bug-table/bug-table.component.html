<div>
<button class="btn btn-primary"  (click)="addBug()"> Add Bug </button>

<div class = "sortheader form-group">
  <label> Sort by: </label>
  <select
    ngModel
    #sortvalue = "ngModel">
    <option value="None"> None </option>
    <option value="Title"> Title </option>
    <option value="Status"> Status </option>
  </select>

  <label> Filter: </label>
  <input  type="text" id="filter" name="filter"
                   required #filtervalue="ngModel" ngModel>


  <button class="btn btn-primary btnapply" (click)="applyChanges( sortvalue.value,
                                                                  filtervalue.value,
                                                                  paginator.pageIndex,
                                                                  paginator.pageSize)"> Apply </button>
</div>

</div>

<div class="mat-elevation-z8">

  <table mat-table matSort [dataSource]="dataSource">

    <ng-container matColumnDef="title">
      <th mat-header-cell mat-sort-header *matHeaderCellDef> Title </th>
      <td mat-cell *matCellDef="let bugs"> {{bugs.title}} </td>
    </ng-container>

    <ng-container matColumnDef="target_date">
      <th mat-header-cell mat-sort-header *matHeaderCellDef> Date </th>
      <td mat-cell *matCellDef="let bugs"> {{bugs.targetDate}} </td>
    </ng-container>

    <ng-container matColumnDef="status">
      <th mat-header-cell mat-sort-header *matHeaderCellDef> Status </th>
      <td mat-cell *matCellDef="let bugs" >
<!--        {{bugs.status}}-->
        <ng-template ngIf="true">
          <button mat-button [matMenuTriggerFor]="menu"

                  (click)="openMenu(bugs.status)"
                  [disabled]="bugs.status === 'Closed' ? true : false"
                  class="option">
                  {{bugs.status}} </button>
          <mat-menu #menu="matMenu" [overlapTrigger]="true">
            <div>
              <button *ngFor="let tr of transitions" mat-menu-item
                      (click)="setTransition(bugs.id, bugs.title,bugs.description, bugs.version, bugs.targetDate,
                                             tr, bugs.fixedVersion, bugs.severity, bugs.createdByUser, bugs.assignedTo)">

                {{tr}}
              </button>
            </div>
          </mat-menu>
        </ng-template>
      </td>
    </ng-container>

    <ng-container matColumnDef="severity">
      <th mat-header-cell mat-sort-header *matHeaderCellDef> Severity </th>
      <td mat-cell *matCellDef="let bugs">
        {{bugs.severity}}
      </td>
    </ng-container>

    <ng-container matColumnDef="createdByUser">
      <th mat-header-cell mat-sort-header *matHeaderCellDef> Created By </th>
      <td mat-cell *matCellDef="let bugs"> {{bugs.createdByUser}} </td>
    </ng-container>

    <ng-container matColumnDef="assignedTo">
      <th mat-header-cell mat-sort-header *matHeaderCellDef> Assigned To </th>
      <td mat-cell *matCellDef="let bugs"> {{bugs.assignedTo}} </td>
    </ng-container>

    <ng-container matColumnDef="actions">
      <th mat-header-cell  *matHeaderCellDef > Details </th>
      <mat-cell *matCellDef="let bugs">
        <button mat-raised-button class="viewbtn" color="primary" (click)="viewBugPopUp(myView)" >
           View
        </button>
       <ng-template #myView> <app-view-bug *ngIf ="loadComponent" ></app-view-bug> </ng-template>
      </mat-cell>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let bugs; columns: displayedColumns;"></tr>

  </table>
  <mat-paginator
                 [length]="length"
                 [pageSize]="pageSize"
                 [pageSizeOptions]="[5, 10, 25, 50]"></mat-paginator>
</div>




